<!DOCTYPE html>
<html>
<head>      
 <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title></title>
    <link href="bootstrap/bootstrap.css" rel="stylesheet" />
    <link rel="stylesheet" href="style.css" />
    <link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.6.0/pure-min.css">
</head>
<body>
    <div class="tabs">
        <ul class="tab-links">
            <li class="active"><a href="#tabletab">Data Table</a></li>
            <li><a href="#viewtab">Visual Representation</a></li>
        </ul>
        <div class="tab-content">
            <div id="tabletab" class="tab active">
                <table id="nodetable" class="pure-table pure-table-bordered">
                    <thead>
                        <tr>
                            <th>Node</th>
                            <th>State</th>
                            <th>Sensor Value</th>
                            <th>Voltage Value</th>
                            <th>Nodes Heard</th>
                            <th>No Longer Heard</th>
                            <th>Parent</th>
                            <th>Time</th>
                            <th>Message</th>
                        </tr>
                    </thead>
                    <tbody data-bind="foreach: distinctNodes">
                        <td><span data-bind="text:nodeId"></span><span data-bind="if: isSink()" title="Sink Node" class="checkmark">&nbsp;&nbsp;&nbsp;&#10004;</span></td>
                        <td data-bind="text: currentState()"></td>
                        <td data-bind="text: lastSensorValue()"></td>
                        <td data-bind="text: lastVoltageValue()"></td>
                        <td data-bind="text: nodesHeard()"></td>
                        <td data-bind="text: nodesNoLongerHeard()"></td>
                        <td data-bind="text: parentId()"></td>
                        <td data-bind="text: currentTime()"></td>
                    </tbody>
                </table>
            </div>
            <div id="viewtab" class="tab" class="canvas">
                <div>
                    <div data-bind="foreach: distinctNodesHierarchy">
                        <canvas data-bind="attr: {id: 'canvas' + nodeId}" style="position:absolute; z-index:999"></canvas>
                    </div>
                    <div class="node-holder" data-bind="foreach: distinctNodesHierarchy">
                        <a class="circle" 
                             data-bind="css: { 'node-good': status() == 'good', 'node-warn': status() == 'warning', 
                                                'node-error': status() == 'error', 'sink-node': isSink(), 
                                                'parent-highlight': isParentHighlight() },
                                        popover: {options:{title:'Node ' + nodeId, placement:'right'}, 
                                                    template: 'popoverTemplate', 
                                                    data: {time: currentTime(), parent: parentId(), 
                                                            state: currentState(),
                                                            sensorVal: lastSensorValue(),
                                                            nodesHeard: nodesHeard(),
                                                            nodesNotHeard: nodesNoLongerHeard()} }, 
                                        text: nodeId, 
                                        attr: {id: 'nodeCircle' + nodeId},
                                        click: $parent.toggleParentHighlight">
                        </a>
                        <div data-bind="if: $parent.shouldGoToNextLevel($data, $index()), 
                                        style: { display: $parent.shouldGoToNextLevel($data, $index()) ? 'block' : 'inline-block'}">
                            <hr style="padding-left: 20px; width: 90%;">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script type="text/html" id="popoverTemplate">
        <div style="font-size:x-small; font-style:italic; text-align:center">Last received: <span data-bind="text: time"></span></div>
        <div class="content-holder odd-row">
            <div class="content-label">Parent: </div><div class="content-data" data-bind="text: parent"></div>
        </div>
        <div class="content-holder">
            <div class="content-label">Sensor Value: </div><div class="content-data" data-bind="text: sensorVal"></div>
        </div>
        <div class="content-holder odd-row">
            <div class="content-label">State: </div><div class="content-data" data-bind="text: state"></div>
        </div>
        <div class="content-holder">
            <div class="content-label">Nodes Heard: </div><div class="content-data" data-bind="text: nodesHeard"></div>
        </div>
        <div class="content-holder odd-row">
            <div class="content-label">Nodes Missing: </div><div class="content-data" data-bind="text: nodesNotHeard"></div>
        </div>
    </script>
    
    <script type="text/javascript" src="jquery-1.11.3.min.js"></script>
    <script type="text/javascript" src="underscore.js"></script>
    <script type="text/javascript" src="knockout-3.4.0.js"></script>
    <script src="knockout.mapping.js" type="text/javascript"></script>
    <script type="text/javascript" src="bootstrap/bootstrap.min.js"></script>
    <script type="text/javascript" src="knockstrap.min.js"></script>
    <script type="text/javascript" src="main.js"></script>
</body>
</html>